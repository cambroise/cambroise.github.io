<!DOCTYPE html>
<html lang="en"><head>
<script src="Lecture-EM_files/libs/clipboard/clipboard.min.js"></script>
<script src="Lecture-EM_files/libs/quarto-html/tabby.min.js"></script>
<script src="Lecture-EM_files/libs/quarto-html/popper.min.js"></script>
<script src="Lecture-EM_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="Lecture-EM_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Lecture-EM_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="Lecture-EM_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="Lecture-EM_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.433">

  <meta name="author" content="Christophe Ambroise">
  <meta name="dcterms.date" content="2023-11-13">
  <title>Expectation-Maximisation algorithm</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="Lecture-EM_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="Lecture-EM_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="Lecture-EM_files/libs/revealjs/dist/theme/quarto.css">
  <link href="Lecture-EM_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="Lecture-EM_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="Lecture-EM_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="Lecture-EM_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Expectation-Maximisation algorithm</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Christophe Ambroise <a href="https://orcid.org/0000-0002-8148-0346" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a>
</div>
<div class="quarto-title-author-email">
<a href="mailto:christophe.ambroise@univ-evry.fr">christophe.ambroise@univ-evry.fr</a>
</div>
        <p class="quarto-title-affiliation">
            UEVE, UMR CNRS 8071
          </p>
    </div>
</div>

  <p class="date">November 13, 2023</p>
</section>
<section>
<section id="em-algorithm" class="title-slide slide level1 center" data-background-color="#40666e">
<h1>EM algorithm</h1>

</section>
<section id="mixture-models-and-the-em-algorithm" class="slide level2">
<h2>Mixture models and the EM algorithm</h2>
<h3 id="latent-variable-models">Latent variable models</h3>
<p>Assume that the observed variables are correlated because they arise from a hidden common “cause”. Model with hidden variables are also known as latent variable models or LVMs.</p>
<h3 id="latent-variables">Latent variables</h3>
<p>In general there are <span class="math inline">\(K\)</span> latent variables, <span class="math inline">\(z_{i1},...,z_{iK}\)</span>, and <span class="math inline">\(p\)</span> visible variables, <span class="math inline">\(x_{i1},...,x_{ip}\)</span>, where usually <span class="math inline">\(p &gt;&gt; K\)</span>. If we have <span class="math inline">\(K &gt; 1\)</span>, there are many latent factors contributing to each observation, so we have a many-to-many mapping. If <span class="math inline">\(K = 1\)</span>, we we only have a single latent variable; in this case, <span class="math inline">\(z_i\)</span> is usually discrete, and we have a one-to-many mapping.</p>
</section>
<section id="mixture-models" class="slide level2">
<h2>Mixture models</h2>
<p>The simplest form of LVM is when <span class="math inline">\(z_i \in \{1,..., K\}\)</span>, representing a discrete latent state:</p>
<ul>
<li><span class="math inline">\(p(z_i) = Cat(\pi)\)</span> (proportions)</li>
<li><span class="math inline">\(p(x_i|z_i = k) = p_k(x_i)\)</span> (class densities, components),</li>
</ul>
<p><span class="math display">\[
p(x_i | \theta)=\sum_k \pi_k p_k(x_i)
\]</span> <span class="math inline">\(\pi_k\)</span> satisfy <span class="math inline">\(0 \leq \pi_k \leq 1\)</span> and <span class="math inline">\(\sum_k \pi_k = 1\)</span>.</p>

<img data-src="../Silo-Images/mixture-3-gaussian.png" class="r-stretch"></section>
<section id="mixtures-of-gaussians" class="slide level2">
<h2>Mixtures of Gaussians</h2>
<p>In this model, each base distribution in the mixture is a multivariate Gaussian with mean <span class="math inline">\(\boldsymbol \mu_k\)</span> and covariance matrix <span class="math inline">\(\boldsymbol \Sigma_k\)</span>: <span class="math display">\[
p(x_i | \theta)=\sum_k \pi_k \mathcal N(x_i| \boldsymbol \mu_k,\boldsymbol \Sigma_k)
\]</span></p>
</section>
<section id="mixture-of-multinoullis" class="slide level2">
<h2>Mixture of multinoullis</h2>
<p>class- conditional density is a product of Bernoullis:</p>
<p><span class="math display">\[
p(x_i | z_i=k, \theta)  = \prod_j Ber(x_{ij} | \mu_{jk}).
\]</span></p>
</section>
<section id="em-algorithm-1" class="slide level2">
<h2>EM algorithm</h2>
<h3 id="data">Data</h3>
<ul>
<li>Observed data <span class="math inline">\(\boldsymbol: x_{1:n}\)</span></li>
<li>Missing (or hidden) data : <span class="math inline">\(\boldsymbol: z_{1:n}\)</span></li>
</ul>
<h3 id="principle">Principle</h3>
<ul>
<li>Starting from <span class="math inline">\(\theta^0\)</span></li>
<li>At step <span class="math inline">\(q\)</span>
<ul>
<li>E(xpectation) step: <span class="math inline">\(Q(\theta,\theta^q) = E_{Z_{1:n} | \boldsymbol x_{1:n}}[\log P( \boldsymbol x_{1:n},\boldsymbol z_{1:n},\theta)]\)</span></li>
<li>M(aximisation) step: <span class="math inline">\(\theta^{q+1} = argmax_\theta Q(\theta,\theta^q)\)</span></li>
</ul></li>
</ul>
</section>
<section id="em-algorithm-2" class="slide level2">
<h2>EM algorithm</h2>
<p>At each iteration the log-likelihood of the parameters increase</p>
<p><span class="math display">\[\begin{eqnarray*}
Q(\theta^{q+1},\theta^q) &amp; \geq &amp; Q(\theta^q,\theta^q)\\
0 &amp; \leq &amp; Q(\theta^{q+1},\theta^q) - Q(\theta^{q},\theta^q) \\
0 &amp; \leq &amp; E_{Z_{1:n} | \boldsymbol x_{1:n}}[\log \frac{P( \boldsymbol x_{1:n},\boldsymbol z_{1:n},\theta^{q+1})}{P( \boldsymbol x_{1:n},\boldsymbol z_{1:n},\theta^{q})}] \\
E_{Z_{1:n} | \boldsymbol x_{1:n}}[\log \frac{P( \boldsymbol x_{1:n},\boldsymbol z_{1:n},\theta^{q+1})}{P( \boldsymbol x_{1:n},\boldsymbol z_{1:n},\theta^{q})}]  &amp;\underset{Jensen}{\leq}&amp;
\log E_{Z_{1:n} | \boldsymbol x_{1:n}}[\frac{P( \boldsymbol x_{1:n},\boldsymbol z_{1:n},\theta^{q+1})}{P( \boldsymbol x_{1:n},\boldsymbol z_{1:n},\theta^{q})}] \\
0  &amp; \leq &amp;
\log \int \frac{P( \boldsymbol x_{1:n},\boldsymbol z_{1:n},\theta^{q+1})}{P( \boldsymbol x_{1:n},\boldsymbol z_{1:n},\theta^{q})} P( \boldsymbol z_{1:n} | \boldsymbol x_{1:n}, \theta^{q}) d  \boldsymbol z_{1:n} \\
0  &amp; \leq &amp;
\log \frac{P( \boldsymbol x_{1:n},\theta^{q+1})}{P( \boldsymbol x_{1:n},\theta^{q})}
\end{eqnarray*}\]</span></p>
</section>
<section id="example-mixture-of-univariate-gaussians" class="slide level2">
<h2>Example : Mixture of univariate Gaussians</h2>
<p>We have</p>
<ul>
<li><strong>Observed data</strong> <span class="math inline">\(x_1, \cdots, x_n\)</span></li>
<li><strong>Missing data</strong> <span class="math inline">\(z_1,\cdots, z_n\)</span></li>
</ul>
<p>and assume that</p>
<p><span class="math display">\[
f(x) = \pi_1 f_1(x) + (1-\pi_1) f_2(x),
\]</span> where</p>
<ul>
<li><span class="math inline">\(\pi_1 = P(z=1)\)</span></li>
<li><span class="math inline">\(f_k(x) = P(x|z=k)=\mathcal{N}(x; \mu_k, \sigma_k^2)\)</span></li>
</ul>
</section>
<section id="e-step-expectation-of-complete-log-likelihood" class="slide level2">
<h2>E step: Expectation of Complete log-likelihood</h2>
<h3 id="complete-log-likelihood">Complete log-likelihood</h3>
<p><span class="math display">\[\begin{eqnarray*}
\log P(\boldsymbol x_{1:n},  \boldsymbol z_{1:n}; \Theta  ) &amp;=&amp; \sum_{i=1}^n \sum_{k=1}^K \mathbb I_{(z_i=k)} \log P( x_{i},   z_{i}=k; \Theta_k  ) \\
&amp;=&amp; \sum_{k=1}^K \mathbb I_{(z_i=k)} \log P(z_{i}=k; \Theta_k  )\underbrace{P( x_{i}|  z_{i}=k; \Theta_k)}_{f_k(x_i|\theta_k)}
\end{eqnarray*}\]</span></p>
<h3 id="expectation">Expectation</h3>
<p><span class="math display">\[
\mathbb E_{x|z; \Theta^q}[\log P(\boldsymbol x_{1:n},\boldsymbol z_{1:n}; \Theta ) ] = \sum_{i,k}\mathbb E_{x|z; \Theta^q} [\mathbb I_{(z_i=k)} ] \log P( x_{i},   z_{i}=k; \Theta_k  )
\]</span></p>
</section>
<section id="e-step" class="slide level2">
<h2>E-step</h2>
<p>Conditional probabilities</p>
<p><span class="math display">\[
\mathbb E_{x|z; \Theta^q} [\mathbb I_{(z_i=k)} ] = t_{ik}^q
\]</span></p>
</section>
<section id="m-step" class="slide level2">
<h2>M step</h2>
<p>Maximisation</p>
</section>
<section id="exercice" class="slide level2">
<h2>Exercice</h2>
<p>Program an EM algorithm for univariate Poisson mixtures</p>
</section>
<section id="model-selection" class="slide level2" data-background-color="#40666e">
<h2>Model selection</h2>
</section>
<section id="model-selection-how-many-clusters" class="slide level2">
<h2>Model selection: How many clusters ?</h2>
<p>The number of clusters <span class="math inline">\(K\)</span> controls the model complexity.</p>
<p>Choosing <span class="math inline">\(K\)</span> is an example of model selection.</p>
<p>The optimal Bayesian approach is to pick the model with the largest marginal likelihood, <span class="math display">\[
K^* = \arg \max_k p(\mathcal D|K).
\]</span></p>
<p>In practice,</p>
<ol type="1">
<li>Simple approximations, such as BIC, ICL can be used.</li>
<li>We can use the cross-validated likelihood as a performance measure</li>
<li>An alternative approach is to perform stochastic sampling in the space of models (MCMC)</li>
</ol>
</section>
<section id="the-laplace-approximation" class="slide level2">
<h2>The Laplace approximation</h2>
<h3 id="taylor-expansion">Taylor expansion</h3>
<p>For functions of multiple variables <span class="math inline">\(f(\boldsymbol z)=f(z_1,z_2,\cdots,z_p)\)</span>.</p>
<p><span class="math display">\[
\log f(\boldsymbol z)\approx \log f(\boldsymbol z_0)+\nabla \log f(\boldsymbol z_0)^T(\boldsymbol z−\boldsymbol z_0)+\frac{1}{2}(\boldsymbol z−\boldsymbol z_0)^T A f(\boldsymbol z_0)(\boldsymbol z−\boldsymbol z_0).
\]</span> where <span class="math inline">\(A\)</span> is the Hessian matrix of second derivatives of <span class="math inline">\(\log f(\boldsymbol z)\)</span> at <span class="math inline">\(z=z_0\)</span>.</p>
</section>
<section id="the-laplace-approximation-1" class="slide level2">
<h2>The Laplace approximation</h2>
<h3 id="gaussian-approximation-to-a-probability-density-defined-over-a-set-of-continuous-variables.">Gaussian approximation to a probability density defined over a set of continuous variables.</h3>
<p>Considering the density <span class="math display">\[
p(\boldsymbol z) = \frac{1}{Z} f(\boldsymbol z)
\]</span> The normalizing constant is <span class="math display">\[\begin{eqnarray*}
Z &amp; =&amp; \int f(\boldsymbol z) d\boldsymbol z \\
  &amp; = &amp;f(\boldsymbol z_0)  \int \exp{-\frac{1}{2}(\boldsymbol z_-\boldsymbol z_0)^TA (\boldsymbol z_-\boldsymbol z_0)}d \boldsymbol z\\
  &amp; \approx &amp; f(\boldsymbol z_0) \frac{(2\pi)^{p/2}}{|A|^{1/2}}
\end{eqnarray*}\]</span> where <span class="math inline">\(\boldsymbol z_0\)</span> is a mode of the distribution (where <span class="math inline">\(\nabla \log f(\boldsymbol z_0)=\boldsymbol 0\)</span>)</p>
</section>
<section id="bic" class="slide level2 allowframebreaks">
<h2>BIC</h2>
<p>From the Bayes theorem the model evidence is</p>
<p><span class="math display">\[
p(\mathcal D) =\int p(\boldsymbol \theta) p(D | \boldsymbol \theta) d \boldsymbol \theta
\]</span></p>
<p>Using Laplace approximation in for <span class="math inline">\(f(\boldsymbol \theta)=p(\boldsymbol \theta) p(D | \boldsymbol \theta)\)</span> in <span class="math inline">\(\boldsymbol \theta= \boldsymbol \theta_{MAP}\)</span>:</p>
<p><span class="math display">\[
\log p(\mathcal D) \approx \log p(\mathcal D | \boldsymbol \theta_{MAP})+ \underbrace{\log p(\boldsymbol \theta_{MAP}) + \frac{p}{2} \log(2\pi) -\frac{1}{2} \log |A|}_{Occam factor}
\]</span></p>
<ul>
<li><span class="math inline">\(\log p(\mathcal D | \boldsymbol \theta_{MAP})\)</span> represents the log-likelihood</li>
<li>the Occam factor penalizes the model complexity</li>
</ul>
<p></p>
<p>Assuming a simple Gaussian prior distribution over parameters, with full rank Hessian we can further approximate the Hessian matrix by the fisher information and we get</p>
<p><span class="math display">\[
\log p(\mathcal D) \approx \log p(\mathcal D | \boldsymbol \theta_{MAP}) -\frac{1}{2} p \log n
\]</span></p>
<p>which is known a the BIC (Bayesian Information Criterion) or the Schwartz criterion (1978).</p>
<h3 id="bic-for-chosing-the-number-of-clusters">BIC for chosing the number of clusters</h3>
<p><span class="math display">\[
K_{BIC} =\arg \max_k \log p(\mathcal D | \boldsymbol \theta_{MAP}^k) -\frac{1}{2} p_k \log n
\]</span> where <span class="math inline">\(p_k\)</span> is the number of parameters of the model with <span class="math inline">\(k\)</span> clusters and <span class="math inline">\(\theta_{MAP}^k\)</span> the MAP estimate of the model</p>
</section>
<section id="integrated-complete-likelihood-icl" class="slide level2">
<h2>Integrated Complete Likelihood (ICL)</h2>
<p><span class="math display">\[\begin{eqnarray*}
BIC(k) &amp;= &amp; p(\mathcal D | \boldsymbol \theta_{MAP}^k) -\frac{1}{2} p_k \log n \\
       &amp;= &amp; \mathbb E_{Z|X;\boldsymbol \theta_{MAP}^k}[\log p(X,Z;\boldsymbol \theta_{MAP}^k)] - \mathbb E_{Z|X;\boldsymbol \theta_{MAP}^k}[\log p(Z|X;\boldsymbol \theta_{MAP}^k)] -\frac{1}{2} p_k \log n
\end{eqnarray*}\]</span></p>
<p>Biernacki et al.&nbsp;(2000) proposed to favour clustering with high-confidence (low entropy) by removing entropy term to BIC.</p>
<h3 id="icl-for-chosing-the-number-of-clusters">ICL for chosing the number of clusters</h3>
<p><span class="math display">\[
K_{ICL} =\arg \max_k \log \mathbb E_{Z|X;\boldsymbol \theta_{MAP}^k}[\log p(X,Z;\boldsymbol \theta_{MAP}^k)]  -\frac{1}{2} p_k \log n
\]</span></p>
</section>
<section id="akaike-information-criterion" class="slide level2">
<h2>Akaike information criterion</h2>
<p>Using information theory Akaike (1974) derived an alternative criterion:</p>
<h3 id="aic">AIC</h3>
<p><span class="math display">\[
K_{AIC} =\arg \max_k \log p(\mathcal D| \boldsymbol \theta_k)  - p_k
\]</span></p>
</section>
<section id="penalized-likelihood-criteria" class="slide level2">
<h2>Penalized Likelihood criteria</h2>
<p>Generally AIC chooses more complex models than BIC which chooses more complex models than ICL</p>
<p><span class="math display">\[
K_{AIC} \geq K_{BIC} \geq K_{ICL}
\]</span></p>
</section>
<section id="multivariate-gaussian-mixture-models" class="slide level2">
<h2>Multivariate Gaussian Mixture models</h2>
<p>Assumes <span class="math inline">\(K\)</span> classes in proportion <span class="math inline">\(\pi_1, ..., \pi_K\)</span> with component densities</p>
<p><span class="math display">\[
\boldsymbol x_i | z_i=k \sim \mathcal N_p (\boldsymbol \mu_k, \boldsymbol \Sigma_k)
\]</span></p>
<ul>
<li><span class="math inline">\(\boldsymbol \mu_k \in \mathbb R^p\)</span></li>
<li><span class="math inline">\(\boldsymbol \Sigma_k \in \mathbb R^{p\times p}\)</span></li>
</ul>
<h3 id="number-of-parameters">Number of parameters</h3>
<p><span class="math display">\[
p_k = p.K + p(p-1)/2 + K-1
\]</span></p>
</section>
<section id="covariance-matrix-parametrization" class="slide level2">
<h2>Covariance matrix parametrization</h2>

<img data-src="../Silo-Images/variance-parametrization.png" class="r-stretch"></section>
<section id="relation-to-kmeans-algorithm" class="slide level2 allowframebreaks">
<h2>Relation to kmeans algorithm</h2>
<h3 id="complete-classification-log-likelihood">Complete (Classification) log-likelihood</h3>
<p><span class="math display">\[\begin{eqnarray*}
CL(\boldsymbol \theta; X,Z) &amp; =  &amp; \log \prod_i p(x_i,z_i=k; \boldsymbol \theta_k)\\
&amp; =  &amp; \log \prod_i \prod_k p(x_i,z_i=k; \boldsymbol \theta_k)^{\mathbb I(z_i=k)}\\
&amp; =  &amp; \sum_i \sum_k {\mathbb I(z_i=k)}\log p(x_i,z_i=k; \boldsymbol \theta_k)\\
\end{eqnarray*}\]</span></p>
<h3 id="cem-algorithm">CEM algorithm</h3>
<p><span class="math inline">\(CL(\boldsymbol \theta; X,Z)\)</span> can be maximized using CEM algorithm</p>
<p>if <span class="math inline">\(\forall k\)</span> we habe <span class="math inline">\(\pi_k=\frac{1}{K}\)</span>, <span class="math inline">\(\boldsymbol \Sigma_k = \sigma I_p\)</span> then <span class="math inline">\(CEM \triangleq kmeans\)</span></p>
</section></section>
<section>
<section id="principal-component-analysis" class="title-slide slide level1 center" data-background-color="#40666e">
<h1>Principal Component Analysis</h1>

</section>
<section id="introduction" class="slide level2 allowframebreaks">
<h2>Introduction</h2>
<h3 id="objective">Objective</h3>
<p>The <em>factorial methods</em> aim to</p>
<ul>
<li>visualize, and more generally,</li>
<li>handle multidimensional data.</li>
</ul>
<h3 id="redundancy">Redundancy</h3>
<p>Simultaneously considering many variables is a difficult problem;</p>
<p>Fortunately, the information provided by these variables is often redundant.</p>
<h3 id="a-solution">A solution</h3>
<p>Replace the initial variables with a reduced number of new variables without losing too much information.</p>
<h3 id="principles">Principles</h3>
<p>For example, when the variables are all quantitative, principal component analysis (PCA) seeks to solve this problem by</p>
<ul>
<li>considering the new variables as linear combinations of the initial variables</li>
<li>uncorrelated.</li>
</ul>
<h3 id="original-table-to-synthetic-table">Original table to synthetic table</h3>
<p>We move from an original table <span class="math inline">\(X\)</span> to a synthetic table with the same number of rows but a reduced number of columns <span class="math inline">\(C\)</span>.</p>
<h3 id="history">History</h3>
<p>This method was first developed by K. Pearson (1900) for two variables, and then by H. Hotelling (1933), who extended it to any number of variables.</p>
</section>
<section id="maximizing-the-variance-of-projected-data" class="slide level2 allowframebreaks">
<h2>Maximizing the variance of projected data</h2>
<h3 id="the-cloud-of-individuals">The cloud of individuals</h3>
<p>The data table <span class="math inline">\(X\)</span> is an <span class="math inline">\(n\times p\)</span> real matrix:</p>
<ul>
<li>each row <span class="math inline">\(\boldsymbol x_{i}^T = X_{i\bullet}\)</span> describes an individual with <span class="math inline">\(p\)</span> variables</li>
<li>each column <span class="math inline">\(X^j\)</span> describes a variable with <span class="math inline">\(n\)</span> individuals</li>
</ul>
<h3 id="centering-the-matrix-x">Centering the matrix <span class="math inline">\(X\)</span></h3>
<p>The cloud of individuals is centered around the center of gravity of the cloud (or vector of empirical means):</p>
<p><span class="math display">\[ \bar{X} = \frac{1}{n} \sum_i \boldsymbol x_{i} =
\begin{pmatrix}
X_{i1}\\
X_{i2}\\
...\\
X_{ip}
\end{pmatrix}
\]</span></p>
<p>Without loss of generality, we assume that this mean vector is the zero vector (it is sufficient to center the original matrix <span class="math inline">\(X\)</span>).</p>
<p>Empirical Variance The empirical variance of the cloud is the sum of the variances of each variable:</p>
<p><span class="math display">\[
\hat{\sigma}^2 = \sum_{j=1}^p \hat{\sigma}_j^2
\]</span> where <span class="math inline">\(\hat{\sigma}j^2 = \frac{1}{n} \sum_i X{ij}^2\)</span></p>
<p>Relationship between Empirical Variance and Inertia <span class="math display">\[
n \hat{\sigma}^2 = \sum_i \sum_{j=1}^p X_{ij}^2
\]</span></p>
<p>can also be interpreted as the sum of the distances from the individuals to the center of the cloud.</p>
</section>
<section id="projection-of-individuals" class="slide level2 allowframebreaks">
<h2>Projection of Individuals</h2>
<h3 id="projection-onto-the-boldsymbolu_1-axis">Projection onto the <span class="math inline">\(\boldsymbol{u}_1\)</span> axis</h3>
<p>The vector projection of vector <span class="math inline">\(\boldsymbol x_i\)</span> onto the vector line with direction vector <span class="math inline">\(\boldsymbol{u}_1\)</span> is defined as <span class="math display">\[
c_{i1} \boldsymbol{u}_1
\]</span> where <span class="math inline">\(c_{i1} = &lt; \boldsymbol x_i , \boldsymbol{u}_1&gt;\)</span> is the coordinate of <span class="math inline">\(\boldsymbol x_i\)</span> in the <span class="math inline">\({\boldsymbol{u}_1}\)</span> basis.</p>
<h3 id="projection-onto-the-vector-subspace-with-basis-boldsymbolu_1...-boldsymbolu_d">Projection onto the vector subspace with basis <span class="math inline">\(\boldsymbol{u}_1,..., \boldsymbol{u}_d\)</span></h3>
<p>The vector projection of vector <span class="math inline">\(\boldsymbol x_i\)</span> onto the vector subspace with basis <span class="math inline">\(\boldsymbol{u}_1,..., \boldsymbol{u}_d\)</span> is defined as the vector <span class="math display">\[
c_{i1} \boldsymbol{u}_1 + ... +c_{id} \boldsymbol{u}_d
\]</span> where <span class="math inline">\(c_{ik} = &lt; \boldsymbol x_i , \boldsymbol{u}_k&gt;\)</span> is the <span class="math inline">\(k\)</span>-th coordinate of <span class="math inline">\(\boldsymbol x_i\)</span> in the basis.</p>
</section>
<section id="empirical-covariance-matrix-and-diagonalization" class="slide level2 allowframebreaks">
<h2>Empirical Covariance Matrix and Diagonalization</h2>
<p>The matrix <span class="math inline">\(S =\frac{1}{n} X^t X\)</span> is an estimation of the covariance matrix. It is a symmetric positive definite matrix. Indeed, <span class="math inline">\(S=S^t\)</span> and</p>
<p><span class="math display">\[\begin{align}
\boldsymbol{y}^t S \boldsymbol{y} &amp;=&amp; \boldsymbol{y}^t \frac{1}{n} \sum_i X_i X_i^t \boldsymbol{y} \\
&amp;=&amp; \frac{1}{n} \sum_i (\boldsymbol{y}^t X_i) (X_i^t \boldsymbol{y}) \\
&amp;=&amp; \sum_i | \boldsymbol{y}^t X_i |^2 \geq 0
\end{align}\]</span></p>
<h3 id="interpretation">Interpretation</h3>
<p>The diagonal terms are the empirical variances: <span class="math display">\[\hat{\sigma}j^2 = \frac{1}{n} \sum_i X{ij}^2\]</span> The off-diagonal terms are the empirical covariances: <span class="math display">\[\hat{\rho}{jk}^2 = \frac{1}{n} \sum_i X{ij}X_{ik}\]</span></p>
</section>
<section id="variance-projected-onto-an-axis" class="slide level2 allowframebreaks">
<h2>Variance Projected onto an Axis</h2>
<p>We seek to find <span class="math inline">\(\boldsymbol{v}\)</span> such that the projection of the individuals in <span class="math inline">\(X\)</span> onto the vector <span class="math inline">\(\boldsymbol{v}\)</span> (vector projection) is maximized:</p>
<p><span class="math display">\[
\begin{cases}
\max_{\boldsymbol{v}} \boldsymbol{v}^t S \boldsymbol{v},\
\boldsymbol{v}^t \boldsymbol{v} =1.
\end{cases}
\]</span> where <span class="math inline">\(S =\frac{1}{n} X^t X\)</span>.</p>
<p>If we express <span class="math inline">\(\boldsymbol{v}\)</span> in the (orthonormal) basis of the eigenvectors of <span class="math inline">\(S\)</span>, <span class="math display">\[
\boldsymbol{v} = \sum_{j=1}^p \alpha_j \boldsymbol{u}_j
\]</span></p>
<p>then the previous problem becomes</p>
<p><span class="math display">\[
\begin{cases}
\max_{\alpha_1,..., \alpha_d} (\sum_{j=1}^p \alpha_j \boldsymbol{u}j)^t U D U^t (\sum{j=1}^p \alpha_j \boldsymbol{u}_j),\
\sum_j \alpha_j^2 =1.
\end{cases}
\]</span></p>
<p><span class="math display">\[
\begin{cases}
\max_{\alpha_1,..., \alpha_d} (\sum_{j=1}^p \alpha_j^2 \lambda_j),\
\sum_j \alpha_j^2 =1.
\end{cases}
\]</span></p>
<p>where <span class="math inline">\(\lambda_j\)</span> is the <span class="math inline">\(j\)</span>-th eigenvalue.</p>
</section>
<section id="solution" class="slide level2">
<h2>Solution</h2>
<p>The equation gives a barycenter on the half-line of positive real numbers between <span class="math inline">\(\lambda_1\)</span> and <span class="math inline">\(\lambda_p\)</span>. The maximum value of the barycenter is <span class="math inline">\(\lambda_1\)</span>, and it is obtained for <span class="math inline">\(\alpha_1=1\)</span> and <span class="math inline">\(\alpha_j = 0, \forall j \neq 1\)</span> (because all <span class="math inline">\(\lambda_j\)</span> are positive). Therefore, the solution vector is the eigenvector of <span class="math inline">\(S\)</span> associated with the largest eigenvalue <span class="math inline">\(\lambda_1\)</span>. The projection of <span class="math inline">\(X_i\)</span> onto <span class="math inline">\(\boldsymbol{u}_1\)</span> is the first principal component:</p>
<p><span class="math display">\[
C^1= (c_{11},...,c_{n1})^t
\]</span></p>
<p><span class="math display">\[
C=X U
\]</span></p>
</section>
<section id="reconstruction-formula" class="slide level2">
<h2>Reconstruction Formula</h2>
<p><span class="math display">\[
X = \sum_j C^j  \boldsymbol u_j^t
\]</span></p>
<p>The last relationship shows that the initial dataset can be reconstructed using the principal components and the principal axes. This relationship is called the reconstruction formula. If we limit ourselves to the first <span class="math inline">\(k\)</span> <span class="math inline">\((k&lt;p)\)</span> terms, we obtain an approximation of the initial dataset.</p>
</section>
<section id="quality-of-representation" class="slide level2">
<h2>Quality of Representation</h2>
<h3 id="overall-quality">Overall Quality</h3>
<p>The overall quality of representation of the initial set <span class="math inline">\(X\)</span> on the first <span class="math inline">\(k\)</span> principal components is measured as the percentage of explained variance:</p>
<p><span class="math display">\[\frac{\lambda_1+\ldots+\lambda_k}{\mbox{trace}(S)} \times 100.\]</span></p>
</section>
<section id="relative-contribution-of-an-axis-to-an-individual" class="slide level2">
<h2>Relative Contribution of an Axis to an Individual</h2>
<p>Given that the total inertia of the dataset is <span class="math inline">\(\frac{1}{n} \sum_{i=1}^p | \boldsymbol x_i|^2\)</span>, the quantity <span class="math inline">\(\frac{1}{n} | \boldsymbol x_i |^2\)</span> represents the portion of inertia contributed by each <span class="math inline">\(\boldsymbol x_i\)</span>.</p>
<p>After projection onto the axis <span class="math inline">\(\boldsymbol{u}_{k}\)</span>, the remaining inertia is <span class="math inline">\(\frac{1}{n}(C_{ik})^2\)</span>. Each of the terms <span class="math inline">\(\frac{1}{n} (C_{ik})^2\)</span> represents the portion of the initial inertia <span class="math inline">\(\frac{1}{n} | \boldsymbol x_i |^2\)</span> contributed by individual <span class="math inline">\(i\)</span> and retained by the <span class="math inline">\(k\)</span>-th axis:</p>
<p><span class="math display">\[COR(i,k) = \frac{C_{ik}^2}{\| \boldsymbol x_i \|^2}.\]</span></p>
<p>This quantity also represents the square of the cosine of the angle formed by the individual <span class="math inline">\(\boldsymbol x_i\)</span> and the vector <span class="math inline">\(\boldsymbol{u}_k\)</span>.</p>
<h3 id="quality-of-representation-in-a-subspace">Quality of representation in a subspace</h3>
<p><span class="math display">\[QLT(i,k)=\frac{\sum_{k=1}^kC_{ik}^2} {\| X_i \|^2}=\sum_{i=1}^k COR(i,\alpha).\]</span></p>
</section>
<section id="relative-contribution-of-an-individual-to-an-axis" class="slide level2">
<h2>Relative Contribution of an Individual to an Axis</h2>
<p>Starting from the relationship <span class="math inline">\(\lambda_\alpha=\frac{1}{n} \sum_{i=1}^n (C_{ik})^2\)</span>, we can decompose <span class="math inline">\(\lambda_k\)</span>, the inertia preserved by the axis <span class="math inline">\(\boldsymbol{u}_k\)</span>, in terms of individuals.</p>
<p>The portion of inertia accounted for (or explained) by individual <span class="math inline">\(i\)</span> for the <span class="math inline">\(k\)</span>-th axis. We have: <span class="math display">\[CTR(i,k) = \frac{1}{n} \frac{C_{ik}^2}{\lambda_k}.\]</span></p>
</section>
<section id="interpretation-of-the-new-variables" class="slide level2">
<h2>Interpretation of the New Variables</h2>
<h3 id="correlation-circle">Correlation Circle</h3>
<p>Each original variable has a correlation with the new variables. These correlations are used to interpret the new variables in terms of the original ones. <span class="math display">\[\begin{align*}
\text{cor}(X^j, C^k) &amp;= \text{cor}(X^j, X \boldsymbol{u}_k) = \frac{\text{cov}(X^j, X \boldsymbol{u}_k)}{\sqrt{\mathbb V(X^j)\mathbb V(X\boldsymbol{u}_k)}}
\&amp;=\frac{\lambda_k u^j_k}{\sqrt{ \frac{1}{n} |X^j|^2 \lambda_k}} .
\end{align*}\]</span> because</p>
<p><span class="math inline">\(\mathbb V(X\boldsymbol{u}_k) = \boldsymbol{u}_k ^\top \boldsymbol{S} \boldsymbol{u}_k = \lambda_k\)</span> (see previous calculation) <span class="math inline">\(\text{cov}(X^j, X \boldsymbol{u}_k) = \frac{1}{n} (X^j)^\top X\boldsymbol{u}_k\)</span> is the j-th coordinate of <span class="math inline">\(\frac{1}{n} X^\top X\boldsymbol{u}_k = \lambda_k \boldsymbol{u}_k\)</span>. If the variables have been previously normalized, we obtain <span class="math display">\[
\text{cor}(X^j, C^k) = \sqrt{\lambda_k} u^j_k.
\]</span></p>
</section></section>
<section>
<section id="an-example-of-pca" class="title-slide slide level1 center" data-background-color="#40666e">
<h1>An example of PCA</h1>

</section>
<section id="the-data" class="slide level2">
<h2>The data</h2>
<p>This is the table of grades described. Recall that these data group the grades obtained by nine students in the subjects of mathematics, science, French, Latin, and drawing:</p>
<div class="cell">
<div class="cell-output-display">
<table>
<caption>Grades of 9 students</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">math</th>
<th style="text-align: right;">scie</th>
<th style="text-align: right;">fran</th>
<th style="text-align: right;">lati</th>
<th style="text-align: right;">d.m</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">jean</td>
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">5.5</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">aline</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">8.0</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">annie</td>
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">7.0</td>
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">9.5</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="even">
<td style="text-align: left;">monique</td>
<td style="text-align: right;">14.5</td>
<td style="text-align: right;">14.5</td>
<td style="text-align: right;">15.5</td>
<td style="text-align: right;">15.0</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">didier</td>
<td style="text-align: right;">14.0</td>
<td style="text-align: right;">14.0</td>
<td style="text-align: right;">12.0</td>
<td style="text-align: right;">12.5</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;">andré</td>
<td style="text-align: right;">11.0</td>
<td style="text-align: right;">10.0</td>
<td style="text-align: right;">5.5</td>
<td style="text-align: right;">7.0</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pierre</td>
<td style="text-align: right;">5.5</td>
<td style="text-align: right;">7.0</td>
<td style="text-align: right;">14.0</td>
<td style="text-align: right;">11.5</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;">brigitte</td>
<td style="text-align: right;">13.0</td>
<td style="text-align: right;">12.5</td>
<td style="text-align: right;">8.5</td>
<td style="text-align: right;">9.5</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">evelyne</td>
<td style="text-align: right;">9.0</td>
<td style="text-align: right;">9.5</td>
<td style="text-align: right;">12.5</td>
<td style="text-align: right;">12.0</td>
<td style="text-align: right;">18</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="centering-the-data-table" class="slide level2">
<h2>Centering the data table</h2>
<p>The means of the five variables are respectively 9.67, 9.83, 10.22, 10.05, and 11. The column-centered table <span class="math inline">\(\boldsymbol X\)</span> is obtained by subtracting the corresponding mean from each column:</p>
<div class="cell">
<div class="cell-output-display">
<table>
<caption>Centered Table</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">math</th>
<th style="text-align: right;">scie</th>
<th style="text-align: right;">fran</th>
<th style="text-align: right;">lati</th>
<th style="text-align: right;">d.m</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">jean</td>
<td style="text-align: right;">-3.67</td>
<td style="text-align: right;">-3.83</td>
<td style="text-align: right;">-5.22</td>
<td style="text-align: right;">-4.56</td>
<td style="text-align: right;">-3</td>
</tr>
<tr class="even">
<td style="text-align: left;">aline</td>
<td style="text-align: right;">-1.67</td>
<td style="text-align: right;">-1.83</td>
<td style="text-align: right;">-2.22</td>
<td style="text-align: right;">-2.06</td>
<td style="text-align: right;">-2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">annie</td>
<td style="text-align: right;">-3.67</td>
<td style="text-align: right;">-2.83</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">-0.56</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">monique</td>
<td style="text-align: right;">4.83</td>
<td style="text-align: right;">4.67</td>
<td style="text-align: right;">5.28</td>
<td style="text-align: right;">4.94</td>
<td style="text-align: right;">-3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">didier</td>
<td style="text-align: right;">4.33</td>
<td style="text-align: right;">4.17</td>
<td style="text-align: right;">1.78</td>
<td style="text-align: right;">2.44</td>
<td style="text-align: right;">-1</td>
</tr>
<tr class="even">
<td style="text-align: left;">andré</td>
<td style="text-align: right;">1.33</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">-4.72</td>
<td style="text-align: right;">-3.06</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pierre</td>
<td style="text-align: right;">-4.17</td>
<td style="text-align: right;">-2.83</td>
<td style="text-align: right;">3.78</td>
<td style="text-align: right;">1.44</td>
<td style="text-align: right;">-1</td>
</tr>
<tr class="even">
<td style="text-align: left;">brigitte</td>
<td style="text-align: right;">3.33</td>
<td style="text-align: right;">2.67</td>
<td style="text-align: right;">-1.72</td>
<td style="text-align: right;">-0.56</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">evelyne</td>
<td style="text-align: right;">-0.67</td>
<td style="text-align: right;">-0.33</td>
<td style="text-align: right;">2.28</td>
<td style="text-align: right;">1.94</td>
<td style="text-align: right;">7</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="variance-matrix" class="slide level2">
<h2>Variance matrix</h2>
<p><span class="math display">\[\boldsymbol{S} = \frac{1}{9} \boldsymbol{X}'\boldsymbol{X}\]</span></p>
<div class="cell">
<div class="cell-output-display">
<table>
<caption>Variance Matrix</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">math</th>
<th style="text-align: right;">scie</th>
<th style="text-align: right;">fran</th>
<th style="text-align: right;">lati</th>
<th style="text-align: right;">d.m</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">math</td>
<td style="text-align: right;">11.39</td>
<td style="text-align: right;">9.92</td>
<td style="text-align: right;">2.66</td>
<td style="text-align: right;">4.82</td>
<td style="text-align: right;">0.11</td>
</tr>
<tr class="even">
<td style="text-align: left;">scie</td>
<td style="text-align: right;">9.92</td>
<td style="text-align: right;">8.94</td>
<td style="text-align: right;">4.12</td>
<td style="text-align: right;">5.48</td>
<td style="text-align: right;">0.06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fran</td>
<td style="text-align: right;">2.66</td>
<td style="text-align: right;">4.12</td>
<td style="text-align: right;">12.06</td>
<td style="text-align: right;">9.29</td>
<td style="text-align: right;">0.39</td>
</tr>
<tr class="even">
<td style="text-align: left;">lati</td>
<td style="text-align: right;">4.82</td>
<td style="text-align: right;">5.48</td>
<td style="text-align: right;">9.29</td>
<td style="text-align: right;">7.91</td>
<td style="text-align: right;">0.67</td>
</tr>
<tr class="odd">
<td style="text-align: left;">d.m</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">0.67</td>
<td style="text-align: right;">8.67</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="principal-axes-of-inertia" class="slide level2">
<h2>Principal axes of inertia</h2>
<p>The diagonalization of the variance matrix provides the following eigenvalues (arranged in descending order): <span class="math display">\[\lambda_1=28.2533,  \lambda_2=12.0747, \lambda_3=8.6157, \lambda_4=0.0217, \lambda_5=0.0099.\]</span> and the normalized eigenvectors or principal axes of inertia:</p>
<p><span class="math display">\[
\boldsymbol v_1=\left(\begin{array}{r}0.51\\0.51\\0.49\\0.48\\0.03\end{array}\right),
\boldsymbol v_2=\left(\begin{array}{r}-0.57\\-0.37\\0.65\\0.32\\0.11\end{array}\right),
\boldsymbol v_3=\left(\begin{array}{r}-0.05\\-0.01\\0.11\\0.02\\-0.99\end{array}\right),
\boldsymbol v_4=\left(\begin{array}{r}0.29\\-0.55\\-0.39\\0.67\\-0.03\end{array}\right),
\boldsymbol v_5=\left(\begin{array}{r}-0.57\\0.55\\-0.41\\0.45\\-0.01\end{array}\right).
\]</span></p>
</section>
<section id="quality-of-representation-1" class="slide level2">
<h2>Quality of representation</h2>
<ul>
<li>The inertias of the cloud projected onto the 5 axes are equal to the sum of the eigenvalues.</li>
<li>The inertia of the cloud is equal to trace(S), which is also the sum of the eigenvalues, here 48.975.</li>
<li>The percentages of inertia explained by each axis are therefore 57.69, 24.65, 17.59, 0.04, and 0.02.</li>
<li>The percentages of inertia explained by the principal subspaces are 57.69, 82.34, 99.94, 99.98, and 100.00.</li>
<li>The initial cloud is practically in a 3-dimensional space.</li>
</ul>
</section>
<section id="principal-components-cboldsymbol-x-v" class="slide level2">
<h2>Principal components <span class="math inline">\(C=\boldsymbol X V\)</span></h2>
<div class="cell">
<div class="cell-output-display">
<table>
<caption>Composantes principales</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">jean</td>
<td style="text-align: right;">8.70</td>
<td style="text-align: right;">1.70</td>
<td style="text-align: right;">2.55</td>
<td style="text-align: right;">-0.15</td>
<td style="text-align: right;">-0.12</td>
</tr>
<tr class="even">
<td style="text-align: left;">aline</td>
<td style="text-align: right;">3.94</td>
<td style="text-align: right;">0.71</td>
<td style="text-align: right;">1.81</td>
<td style="text-align: right;">-0.09</td>
<td style="text-align: right;">0.04</td>
</tr>
<tr class="odd">
<td style="text-align: left;">annie</td>
<td style="text-align: right;">3.21</td>
<td style="text-align: right;">-3.46</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.02</td>
</tr>
<tr class="even">
<td style="text-align: left;">monique</td>
<td style="text-align: right;">-9.76</td>
<td style="text-align: right;">-0.22</td>
<td style="text-align: right;">3.34</td>
<td style="text-align: right;">-0.17</td>
<td style="text-align: right;">0.10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">didier</td>
<td style="text-align: right;">-6.37</td>
<td style="text-align: right;">2.17</td>
<td style="text-align: right;">0.96</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">-0.19</td>
</tr>
<tr class="even">
<td style="text-align: left;">andré</td>
<td style="text-align: right;">2.97</td>
<td style="text-align: right;">4.65</td>
<td style="text-align: right;">-2.63</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">0.15</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pierre</td>
<td style="text-align: right;">1.05</td>
<td style="text-align: right;">-6.23</td>
<td style="text-align: right;">1.69</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.04</td>
</tr>
<tr class="even">
<td style="text-align: left;">brigitte</td>
<td style="text-align: right;">-1.98</td>
<td style="text-align: right;">4.07</td>
<td style="text-align: right;">-1.40</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">evelyne</td>
<td style="text-align: right;">-1.77</td>
<td style="text-align: right;">-3.40</td>
<td style="text-align: right;">-6.62</td>
<td style="text-align: right;">-0.16</td>
<td style="text-align: right;">-0.06</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="relative-contributions-of-axes-to-individuals" class="slide level2">
<h2>Relative contributions of axes to individuals</h2>
<div class="cell">
<div class="cell-output-display">
<table>
<caption>Relative contributions of axes to individuals</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">jean</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">aline</td>
<td style="text-align: right;">0.80</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">annie</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">0.53</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">monique</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">didier</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">andré</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pierre</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">brigitte</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.74</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">evelyne</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="relative-contributions-of-individuals-to-axes" class="slide level2">
<h2>Relative contributions of individuals to axes</h2>
<div class="cell">
<div class="cell-output-display">
<table>
<caption>Relative contributions of individuals to axes</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">jean</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.15</td>
</tr>
<tr class="even">
<td style="text-align: left;">aline</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.02</td>
</tr>
<tr class="odd">
<td style="text-align: left;">annie</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">monique</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">didier</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.40</td>
</tr>
<tr class="even">
<td style="text-align: left;">andré</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.25</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pierre</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.36</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">0.02</td>
</tr>
<tr class="even">
<td style="text-align: left;">brigitte</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">evelyne</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">0.04</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="analysis-in-rn" class="slide level2">
<h2>Analysis in <span class="math inline">\(R^n\)</span></h2>
<p>The vectors <span class="math inline">\(\boldsymbol d^{\alpha}\)</span>, which are the principal components associated with the different variables, are formed by the coordinates of all the variables for the same axis <span class="math inline">\(\boldsymbol v_\alpha\)</span>, and they satisfy the relation <span class="math display">\[\boldsymbol d^\alpha = \sqrt{\lambda_\alpha} \boldsymbol v_\alpha.\]</span> We obtain</p>
<div class="cell">
<div class="cell-output-display">
<table>
<caption>Variables</caption>
<tbody>
<tr class="odd">
<td style="text-align: right;">-2.73</td>
<td style="text-align: right;">1.97</td>
<td style="text-align: right;">-0.15</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">0.06</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.69</td>
<td style="text-align: right;">1.29</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">-0.05</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-2.62</td>
<td style="text-align: right;">-2.26</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.04</td>
</tr>
<tr class="even">
<td style="text-align: right;">-2.58</td>
<td style="text-align: right;">-1.12</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">-0.10</td>
<td style="text-align: right;">-0.05</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-0.16</td>
<td style="text-align: right;">-0.39</td>
<td style="text-align: right;">-2.91</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.00</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="analysis-in-rn-1" class="slide level2">
<h2>Analysis in <span class="math inline">\(R^n\)</span></h2>
<p>It is often preferable to represent the projection of the standardized original variables. To do this, simply divide each row of the previous table by the norm of the corresponding variable <span class="math display">\[\|\boldsymbol x^j\|^2 = \frac{1}{9} \sum_{i=1}^9 (x^j_i)^2.\]</span></p>
<p>The <span class="math inline">\(\|\boldsymbol x^j\|\)</span> actually correspond to the standard deviations of the variables. We obtain 3.37, 2.99, 3.47, 2.81, and 2.94, respectively. ::: {.cell} ::: {.cell-output-display} Table: Normalized Variables</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: right;">-0.81</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">0.02</td>
</tr>
<tr class="even">
<td style="text-align: right;">-0.90</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">-0.01</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">-0.02</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-0.75</td>
<td style="text-align: right;">-0.65</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: right;">-0.92</td>
<td style="text-align: right;">-0.40</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">-0.02</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-0.06</td>
<td style="text-align: right;">-0.13</td>
<td style="text-align: right;">-0.99</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
</tr>
</tbody>
</table>
<p>::: :::</p>
</section>
<section id="pca-with-factominer" class="slide level2">
<h2>PCA with FactoMineR</h2>
</section>
<section id="explained-variances" class="slide level2">
<h2>Explained Variances</h2>

<img data-src="Lecture-EM_files/figure-revealjs/unnamed-chunk-21-1.png" width="960" class="r-stretch"></section>
<section id="representation-of-individuals" class="slide level2">
<h2>Representation of Individuals</h2>

<img data-src="Lecture-EM_files/figure-revealjs/unnamed-chunk-22-1.png" width="960" class="r-stretch"></section>
<section id="representation-of-variables" class="slide level2">
<h2>Representation of Variables</h2>

<img data-src="Lecture-EM_files/figure-revealjs/unnamed-chunk-23-1.png" width="960" class="r-stretch"></section>
<section id="relative-contributions-of-axes-to-individuals-1" class="slide level2">
<h2>Relative contributions of axes to individuals</h2>
<div class="cell">
<div class="cell-output-display">
<table>
<caption>Relative contributions of axes to individuals</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Dim.1</th>
<th style="text-align: right;">Dim.2</th>
<th style="text-align: right;">Dim.3</th>
<th style="text-align: right;">Dim.4</th>
<th style="text-align: right;">Dim.5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">jean</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">aline</td>
<td style="text-align: right;">0.80</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">annie</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">0.53</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">monique</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">didier</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">andré</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pierre</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">brigitte</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.74</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">evelyne</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="relative-contributions-of-axes-to-individuals-2" class="slide level2">
<h2>Relative contributions of axes to individuals</h2>

<img data-src="Lecture-EM_files/figure-revealjs/unnamed-chunk-25-1.png" width="960" class="r-stretch"></section>
<section id="contributions-of-individuals-to-axes" class="slide level2">
<h2>Contributions of individuals to axes</h2>
<div class="cell">
<div class="cell-output-display">
<table>
<caption>Contributions of individuals to axes</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Dim.1</th>
<th style="text-align: right;">Dim.2</th>
<th style="text-align: right;">Dim.3</th>
<th style="text-align: right;">Dim.4</th>
<th style="text-align: right;">Dim.5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">math</td>
<td style="text-align: right;">26.47</td>
<td style="text-align: right;">32.14</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">8.34</td>
<td style="text-align: right;">32.78</td>
</tr>
<tr class="even">
<td style="text-align: left;">scie</td>
<td style="text-align: right;">25.70</td>
<td style="text-align: right;">13.84</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">30.59</td>
<td style="text-align: right;">29.85</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fran</td>
<td style="text-align: right;">24.24</td>
<td style="text-align: right;">42.30</td>
<td style="text-align: right;">1.17</td>
<td style="text-align: right;">15.50</td>
<td style="text-align: right;">16.79</td>
</tr>
<tr class="even">
<td style="text-align: left;">lati</td>
<td style="text-align: right;">23.49</td>
<td style="text-align: right;">10.45</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">45.45</td>
<td style="text-align: right;">20.56</td>
</tr>
<tr class="odd">
<td style="text-align: left;">d.m</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">1.27</td>
<td style="text-align: right;">98.50</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.02</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="contributions-of-individuals-to-axes-1" class="slide level2">
<h2>Contributions of individuals to axes</h2>

<img data-src="Lecture-EM_files/figure-revealjs/unnamed-chunk-27-1.png" width="960" class="r-stretch"><div class="footer footer-default">

</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="Lecture-EM_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="Lecture-EM_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="Lecture-EM_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="Lecture-EM_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="Lecture-EM_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="Lecture-EM_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="Lecture-EM_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="Lecture-EM_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="Lecture-EM_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="Lecture-EM_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'convex',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>